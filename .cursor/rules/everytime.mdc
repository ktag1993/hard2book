---
alwaysApply: true
---

- backend in TypeScript deployed on Vercel Functions (backend folder)
- website in React + Vite, mobile-optimized (website folder)
- mobile app planned for future (React + Capacitor, mobile folder)
- database on Supabase (PostgreSQL)
- 2 branches: "dev" (development/preview) and "main" (production)
- Development workflow: work on dev → test → merge to main for production
- Merge command: `git checkout main && git merge dev && git push origin main && git checkout dev`
- github account: ktag1993, always switch to ktag1993 before any git operations
- always update api documentation in backend/apis.md
- always update schema documentation in backend/schema.md
- dont write readme or summarisation md files unless I ask you to.
- answer briefly, dont answer in very long texts unless I ask you to.
- use for_dump folder to create/maintain temporary files/scripts


Product:
- Hard2Book - Get reservations at hard-to-book restaurants
- Snipes reservations the moment they open using direct API calls
- Supports multiple restaurant platforms (TableCheck, Resy, OpenTable, etc.)
- Revenue model: charge per successful booking (Rs. 500 / ~$6 per booking)

Tech Stack:
- Frontend: React + Vite (website, mobile-optimized)
- Backend: TypeScript on Vercel Functions
- Database: Supabase (PostgreSQL with RLS)
- Hosting: Vercel (backend + website)

Architecture:
- /backend/api/ - Vercel serverless functions (API endpoints)
- /backend/lib/ - Shared libraries (supabase client, types, etc.)
- /backend/restaurants/ - Platform-specific adapters (tablecheck/, resy/, opentable/)
- /website/ - React + Vite frontend (mobile-optimized)
- /supabase/migrations/ - Database migrations
- /for_dump/ - Temporary files, scripts, research docs

Restaurant Adapters:
- Each restaurant platform has its own adapter in /backend/restaurants/<platform>/
- Each specific restaurant has a config file: /backend/restaurants/<platform>/<slug>.ts
- Adapters implement: getAvailableSlots(), bookReservation(), confirmReservation()
- First adapter: TableCheck (Pizza 4P's Bangalore)


Vercel:
- Backend project: hard2book-backend
  - Project ID: prj_GFeqtmVBxfT1acGVu4KRGmm2YzaB
  - Dashboard: https://vercel.com/kartikayagarwal1993-2038s-projects/hard2book-backend
- Website project: hard2book-website
  - Project ID: prj_EgOom2ah4VClA4HVNkGcM042nNmA
  - Dashboard: https://vercel.com/kartikayagarwal1993-2038s-projects/hard2book-website
- Org ID: team_C4MpTDIOwTY6fkphUR9ZoXhA
- Deploy via GitHub Actions:
  - Push to dev → Vercel preview deployment
  - Push to main → Vercel production deployment
- Backend deploys from /backend folder
- Website deploys from /website folder


Supabase:
- 2 projects, both in AP South (Mumbai)
- Dev project ref: rfodmefvptpbdeumyyrg
  - URL: https://rfodmefvptpbdeumyyrg.supabase.co
- Prod project ref: ymuqzwdrevefwntjffmg
  - URL: https://ymuqzwdrevefwntjffmg.supabase.co
- Migrations in /supabase/migrations/
- Push migrations: SUPABASE_ACCESS_TOKEN=xxx npx supabase db push --project-ref <ref>
- Credentials in credentials.md (gitignored)

Auth:
- Google OAuth (Sign in with Google)
- Supabase Auth handles the flow (Google provider enabled in Supabase dashboard)
- Frontend uses @supabase/supabase-js for auth
- One Google OAuth client shared for dev + prod (different redirect URIs)

Frontend Design:
- Mobile-first responsive website
- Stack: React + Vite + Tailwind CSS
- Auth: Google Sign-In via Supabase Auth
- Pages:
  - / (homepage - restaurant list with search/filters)
  - /r/[slug] (restaurant detail + slot picker + booking form)
  - /bookings (my bookings list with status badges)
  - /bookings/[id] (booking detail page)
- API base: same Vercel deployment URL (preview for dev, prod for main)


Key Tables:
- users: id, name, email, phone, created_at
- restaurants: id, slug, name, platform, city, country, config (jsonb), active, created_at
- bookings: id, user_id, restaurant_id, target_date, preferred_times (text[]), party_size, status, booked_time, confirmation_code, booking_details (jsonb), payment_status, created_at, booked_at
